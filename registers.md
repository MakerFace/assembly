[Toc]

# 寄存器

> 10 个 32 位寄存器，6 个 16 位寄存器
>
> - 通用寄存器
> - 控制寄存器
> - 段寄存器
>
> 进一步划分为
>
> - 数据寄存器
> - 指针寄存器
> - 索引寄存器

# 数据寄存器

四个 32 位寄存器用于算术、逻辑和其他操作：

- 完整的 32 为数据寄存器：EAX、EBX、ECX、EDX
- 32 位下半部分可用作 4 个 16 位数据寄存器：AX、BX、CX、DX
- 32 为上半部分的低 8 位和高 8 位可用作 8 个 8 位寄存器：

  AH、AL、BH、BL、CH、CL、DH、DL

  > AX is the primary accumulator，用于输入/输出大多数算术运算。
  >
  > BX is known as the base register，用于索引寻址。
  >
  > CX is known as the count register，用于迭代操作中存储循环计数。位移操作中，当移多位时使用CL控制移位的位数。
  >
  > DX is known as the data register，用于输入/输出操作。

# 指针寄存器

主要指 32 位的 EIP、ESP 和 EBP 寄存器，以及相应的 16 右部分 IP、SP、BP。

- Instruction Pointer (IP)，存储下一条要执行的指令的偏移地址
  与 CS 寄存器相关联的 IP(CS:IP)给出代码段中当前指令的完整地址
- Stack Pointer (SP)，提供程序堆栈中的偏移值，与 SS 寄存器(SS:SP)
  相关联的 SP 给出程序堆栈内的数据或地址的当前位置
- Base POinter (SP)，主要引用传递给子程序的参数变量。SS 寄存器中的地址
  与 BP 寄存器中偏移组合获得参数位置；BP 也可以和 DI 和 SI 组合作为特殊寻址的
  基址寄存器

# 索引寄存器

32 位索引寄存器：ESI、EDI 以及低 16 位 SI、DI。SI、DI 用于索引地址、加减法。

- Source Index (SI) 用作字符串操作的源索引
- Destination Index (DI) 用作字符串操作的目标索引

# 控制寄存器

32 位指令指针寄存器和 32 位标志寄存器组合被认为是控制寄存器。

![eflags](https://raw.githubusercontent.com/MakerFace/images/main/2014-05-06.jpg)

许多寄存器涉及比较和数学运算，并且更改标志的状态，并且一些其他条件指令测试这些状态标志的值以将控制流程带到其他位置。

公共标志位是：

- Overflow Flag (OF) 表示符号算术运算后数据的高位溢出
- Direction Flag (DF) 确定移动或比较字符串数据的方向，DF 为 0 时，从左到右，反之从右到左
- Interrupt Flag (IF) 指示是否忽略或处理键盘输入等外部中断。0 为禁用，1 为启用
- Trap Flag (TF) 允许以单步模式设置处理器的操作。使用 DEBUG 程序设置陷入标志，一次执行一条指令或一行指令
- Sign Flag (SF) 表示算术运算结果的符号。正结果将 SF 清除，反之置 1
- Zero Flag (ZF) 表示算术或比较运算的结果。结果非零 SF 清除，反之置 1
- Auxiliary Carry Flag (AF) 包含算术运算后从第 3 位到第 4 位的进位；用于专业算术。当 1 字节算术运算导致从第 3 位进位到第 4 位时，AF 置 1
- Paritry Flag (PF) 表示从算术运算获得的结果中 1 的总数，偶数个 1 将 PF 清除，奇数置 1
- Carry Flag (CF) 在算术运算后，包含来自高位的 0 或 1 的进位。还存储*shift*或*rotate*操作的最后一位

# 细分寄存器

段包含数据、代码、堆栈等

- 代码段：存储要执行的所有指令。16 位代码段寄存器或 CS 寄存器存储代码段的起始地址。
- 数据段：包含数据、常量和工作区域。16 位数据段寄存器或 DS 寄存器存储数据段的起始地址。
- 堆栈段：包含过程或子例程的数据和返回值地址。堆栈段寄存器或 SS 寄存器存储堆栈段起始地址。

除了上述三种段，还有其他额外段及其寄存器：ES，FS，GS，提供用于存储数据的附加段。

> 程序访问存储器位置，段内所有存储器位置都相对于段的起始地址。段首地址可以被 16 或 10H 整除。因此所有存储器地址最右边十六进制是 0，通常不存储在段寄存器中。处理器将段寄存器与段内偏移组合，获取线性地址。
